<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    
    <div id="rpgContainer">
        <div id="init" style="border:1px solid black;">
            <table>
                <thead>
                <tr>
                    <td>Personnage</td>
                    <td>Arme choisie</td>
                    <td>Armure sélectionnée</td>
                </tr>
            </thead>
            <tbody>
                <tr id="persoChoisi"></tr>
                <tr id="armeChoisi"></tr>
                <tr id="armureChoisi"></tr>
            </tbody>
            </table>
        </div>
        <div id="game" style="border:1px solid black;">

        </div>
        <div id="gameover" style="border:1px solid black;">

        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> 
    <script src="personnage.js"></script>
    <script src="armes.js"></script>
    <script src="armures.js"></script>
    <script src="archetypes.js"></script>
    <script>
    $(function(){

        /* variables globales */

        var createSelectFromArray = function(str_id, data, container){
            // 1. creer l'element <select>
            let select = document.createElement("select");
            select.setAttribute("id", str_id);

            // 2. LOOP sur data creer les elements <option>
            data.forEach(function(item, key){
                let option = document.createElement("option");
                option.setAttribute("value", key);
                option.innerText = item.toString();
                select.append(option);
            });
                
            // 3. ajouter l'element a un conteneur specifique
            container.append(select);
        };


        // initialisation des collections d'objets [Archetypes, Armes, Armures]
        var list_archetypes = [];
        var list_armes = [];
        var list_armures = [];

        array_archetypes.forEach(function(item, key){
            list_archetypes.push( new Archetype(item) );
        });
        array_armes.forEach(function(item, key){
            list_armes.push( new Arme(item) );
        });
        array_armures.forEach(function(item, key){
            list_armures.push( new Armure(item) );
        });

        
       
        var select_container = $("#init");
        createSelectFromArray("Archetypes", list_archetypes, $(select_container) );
        createSelectFromArray("Armes", list_armes, $(select_container) );
        createSelectFromArray("Armures", list_armures, $(select_container) );


        var archetype = $("#Archetypes");
        var armure = $("#Armures");
        var arme = $("#Armes");
        var selected_Archetype = "";
        var selected_Arme ="";
        var selected_Armure ="";
        var init = $('#init');

        archetype.on('change',function(){
            //On récupère l'ID de l'élément sélectionné
            var selectedPerso = document.getElementsByName('persoChoisi').empty();
            selectedPerso.empty();
            selected_Archetype = archetype.children("option:selected").val();
            console.log(selected_Archetype);
            console.log(list_archetypes[selected_Archetype]);
            var arche = document.createElement("p");
            arche.setAttribute("name","persoChoisi");
            arche.innerText =list_archetypes[selected_Archetype];
            document.getElementsByName('persoChoisi').append(arche);
        });

        arme.on('change',function(){
            //On récupère l'ID de l'élément sélectionné
            $('#armeChoisi').empty();
            selected_Arme = arme.children("option:selected").val();
            console.log(selected_Arme);
            console.log(list_armes[selected_Arme]);
            var armes = document.createElement("p");
            armes.setAttribute("name","armeChoisi");
            armes.innerText =list_armes[selected_Arme];
            $('#armeChoisi').append(armes);
        });

        armure.on('change',function(){
            //On récupère l'ID de l'élément sélectionné
            var selectedArmure = document.getElementsByName('persoChoisi');
            selectedArmure.empty();
            selected_Armure = armure.children("option:selected").val();
            console.log(selected_Armure);
            console.log(list_armures[selected_Armure]);
            var armures = document.createElement("p");
            armures.setAttribute("name","armureChoisi");
            armures.innerText = list_armures[selected_Armure];
            $('#armureChoisi').append(armures);
            
        });
    });
    </script>
</body>
</html>